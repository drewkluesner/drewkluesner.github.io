<!doctype html>
<html>
<head>
  <title>Batch Update Google Sheets</title>
</head>
<body>
  <button id="button">Update Sheet</button>
  <script src="https://apis.google.com/js/client.js"></script>
  <script>
    var clientId = "172471412542-4hj16ngmoeo9sg314p81gj66p37to1jp.apps.googleusercontent.com";
    var scope = "https://www.googleapis.com/auth/spreadsheets";

    gapi.load("client:auth2", function() {
      gapi.auth2.init({
        client_id: clientId,
        scope: scope
      });
    });

    function batchUpdate(accessToken) {
      // Replace the ID below with the ID of your Google Sheets document
      var sheetId = "1G9mqNZEhJdft4ZixKTqAHxNZ8lAcptheL4kxSsX3Zzg";
      var url = "https://sheets.googleapis.com/v4/spreadsheets/" + sheetId + ":batchUpdate";

      var data = {
        "requests": [
          {
            "updateCells": {
              "range": {
                "sheetId": 0,
                "startRowIndex": 0,
                "endRowIndex": 10,
                "startColumnIndex": 0,
                "endColumnIndex": 3
              },
              "fields": "*"
            }
          }
        ]
      };

      var options = {
        method: 'POST',
        headers: {
          "Authorization": "Bearer " + accessToken,
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      };

      fetch(url, options)
        .then(function(response) {
          return response.json();
        })
        .then(function(json) {
          console.log(json);
        });
    }

    // When the button is clicked, get the OAuth 2.0 access token and perform the batch update
    document.getElementById('button').onclick = function() {
      var isSignedIn = gapi.auth2.getAuthInstance().isSignedIn.get();
      if (!isSignedIn) {
        gapi.auth2.getAuthInstance().signIn();
      } else {
        var accessToken = gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token;
        batchUpdate(accessToken);
      }
    };
  </script>
</body>
</html>
