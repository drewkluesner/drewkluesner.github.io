<html>
<head>
  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    // Replace with your client ID from the Developer Console
    
    const CLIENT_ID = '172471412542-mttk2k0rput8li38i7uhp615pfns7vb7.apps.googleusercontent.com';
    const API_KEY = 'AIzaSyC_h1-qrTYtvQLEn3PEz8YSh-Uzr4v0DV0';    
    
    
    // Replace with the ID of the spreadsheet you want to update
    var SPREADSHEET_ID = '1G9mqNZEhJdft4ZixKTqAHxNZ8lAcptheL4kxSsX3Zzg';

    // Set the scope for the Google Sheets API
    var SCOPES = ['https://www.googleapis.com/auth/spreadsheets'];

    function handleClientLoad() {
      // Load the API client and auth2 library
      gapi.load('client:auth2', initClient);
    }

    function initClient() {
      // Initialize the client with the client ID and the scope
      gapi.client.init({
        clientId: CLIENT_ID,
        scope: SCOPES.join(' ')
      }).then(function() {
        // Check if the current user has authorized the app
        if (gapi.auth2.getAuthInstance().isSignedIn.get()) {
          // Update the Google Sheet
          updateSheet();
        } else {
          // Show the sign-in button
          document.getElementById('sign-in-button').style.display = 'block';
          document.getElementById('sign-in-button').onclick = function() {
            gapi.auth2.getAuthInstance().signIn();
          };
        }
      });
    }

    function updateSheet() {
      // Set up the request
      const request = {
        spreadsheetId: SPREADSHEET_ID, // The ID of the spreadsheet to update
        range: 'Data!A2', // The range of cells to update
        valueInputOption: 'RAW', // How the input data should be interpreted
        resource: {
          values: [[Math.random()]] // The new values to set in the cells
        },
        auth: gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse(true)
      };

      // Make the request to update the cells
      gapi.client.sheets.spreadsheets.values.update(request).then(function(response) {
        console.log(response.result);
      }, function(response) {
        console.error(response.result.error);
      });
    }
  </script>
</head>
<body>
  Drew was here.
  <button id="sign-in-button" style="display: none;">Sign in</button>
</body>
</html>
